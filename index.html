<!DOCTYPE html>
<html>
<body>
    <style type="text/css">
        .button {
            background-color: #4CAF50;
            /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            width: 50%;
            margin: 25%;
        }
    </style>

    <button type="button" class="button" onclick="sendMessage();">Complete Booking</button>
	<input type="hidden" id="myField" value="" />
    <script type="text/javascript">
	
	 window.fbAsyncInit = function() {
    FB.init({
      appId      : '190368434714859', // App ID
      channelUrl : 'https://obscure-stream-93442.herokuapp.com/', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    alert("this statement never gets called either");
  };

  // Load the SDK Asynchronously
  
   
	var globPsid="";
	(function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.com/en_US/messenger.Extensions.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, "script", "Messenger"));		 
		
	window.extAsyncInit = function () {
    // the Messenger Extensions JS SDK is done loading
    MessengerExtensions.getUserID(function success(uids) {
        var psid = uids.psid;//This is your page scoped sender_id
		 console.log("---window.extAsyncInit  psid "+psid); 
		 
		 //document.getElementById('myField').value = psid;
		 
    }, function error(err) {
        alert("Messenger Extension Error: " + err);
    });
};	
	  function sendMessage() {
		console.log("**********inside send message");			
            MessengerExtensions.requestCloseBrowser(function success() {

            }, function error(err) {

            });
    
	
    </script>
</body>
</html>